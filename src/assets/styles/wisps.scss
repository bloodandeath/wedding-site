/* Sparkly Particle Wisps (Vue-rendered) */
.wisps {
    position: absolute;
    inset: 0;
    width: 100%;

    /* IMPORTANT: make the field as tall as the document */
    height: var(--pageH, 100vh);

    pointer-events: none;
    overflow: hidden;
    z-index: 0;

    /* Uniform container-level parallax (single compositor op) */
    translate: 0 var(--wispPar, 0px);
    will-change: translate;
}

/* Base wisp visual: POINT + BLOOM (not a "ball") */
.wisp {
    position: absolute;
    left: var(--x);
    top: var(--y);

    width: var(--s);
    height: var(--s);
    border-radius: 999px;

    background: transparent;

    /* crisp core + soft bloom */
    box-shadow:
            0 0 0 0.7px rgba(255, 255, 255, 0.92),
            0 0 12px rgba(255, 255, 255, 0.42),
            0 0 22px rgba(120, 255, 200, 0.28),
            0 0 36px rgba(32, 99, 63, 0.22);

    opacity: 0.82;

    mix-blend-mode: screen;

    transform: translate3d(0, 0, 0);
    will-change: transform, opacity;

    animation:
        wisp-drift var(--dur) ease-in-out var(--delay) infinite,
        wisp-twinkle var(--tw) ease-in-out var(--twDelay) infinite;
}


/* Soft star glint (rounded, not a hard right angle) */
.wisp::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;

    width: calc(var(--s) * 12);
    height: calc(var(--s) * 12);
    transform: translate(-50%, -50%) rotate(var(--rot, 0deg)) scale(0.85);

    pointer-events: none;
    opacity: 0;

    /* 4-point star + soft core */
    background:
            radial-gradient(circle, rgba(255,255,255,0.70), rgba(255,255,255,0) 38%),
            radial-gradient(circle, rgba(255,255,255,0.30), rgba(255,255,255,0) 62%),
            conic-gradient(
                            rgba(255,255,255,0) 0deg,
                            rgba(255,255,255,0.95) 7deg,
                            rgba(255,255,255,0) 14deg,
                            rgba(255,255,255,0) 90deg,
                            rgba(255,255,255,0.95) 97deg,
                            rgba(255,255,255,0) 104deg,
                            rgba(255,255,255,0) 180deg,
                            rgba(255,255,255,0.95) 187deg,
                            rgba(255,255,255,0) 194deg,
                            rgba(255,255,255,0) 270deg,
                            rgba(255,255,255,0.95) 277deg,
                            rgba(255,255,255,0) 284deg,
                            rgba(255,255,255,0) 360deg
            );

    /* KEY: taper outward so the spikes don't look wide at the edge */
    -webkit-mask-image: radial-gradient(
                    circle,
                    #000 0%,
                    #000 22%,
                    rgba(0,0,0,0.85) 34%,
                    rgba(0,0,0,0.35) 50%,
                    rgba(0,0,0,0.00) 66%
    );
    mask-image: radial-gradient(
                    circle,
                    #000 0%,
                    #000 22%,
                    rgba(0,0,0,0.85) 34%,
                    rgba(0,0,0,0.35) 50%,
                    rgba(0,0,0,0.00) 66%
    );

    filter: blur(0.55px);
}

/* --- Generic keyframes using per-particle CSS custom properties --- */

/* 6-point organic drift path — each wisp gets unique motion from its --dx / --dy */
@keyframes wisp-drift {
    0%, 100% { transform: translate3d(0, 0, 0); }
    18%      { transform: translate3d(calc(var(--dx) * -0.4),  calc(var(--dy) * 0.6),  0); }
    36%      { transform: translate3d(calc(var(--dx) * 0.8),   calc(var(--dy) * -0.3), 0); }
    54%      { transform: translate3d(var(--dx), var(--dy), 0); }
    72%      { transform: translate3d(calc(var(--dx) * -0.6),  calc(var(--dy) * 0.9),  0); }
    88%      { transform: translate3d(calc(var(--dx) * 0.3),   calc(var(--dy) * -0.5), 0); }
}

/* Soft twinkle: gentle breathing, no flicker */
@keyframes wisp-twinkle {
    0%, 100% {
        opacity: 0.38;
        filter: blur(0.10px);
    }
    35% {
        opacity: 0.62;
        filter: blur(0.22px);
    }
    55% {
        opacity: 0.92;
        filter: blur(0.34px);
    }
    70% {
        opacity: 0.52;
        filter: blur(0.16px);
    }
}

/* Occasional star glint — only applied to .has-glint wisps */
@keyframes wisp-glint {
    0%, 80%, 100% {
        opacity: 0;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.82);
        filter: blur(0.60px);
    }
    86% {
        opacity: 0.22;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.94);
        filter: blur(0.56px);
    }
    90% {
        opacity: 0.70;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(1.08);
        filter: blur(0.48px);
    }
    94% {
        opacity: 0.14;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.92);
        filter: blur(0.58px);
    }
}

.wisp.has-glint::before {
    animation: wisp-glint var(--glintDur) ease-in-out var(--glintDelay) infinite;
}

/* ===== Watercolor Background Layer ===== */

.watercolor-layer {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
    background-color: transparent;
    translate: 0 var(--wcPar, 0px);
    will-change: translate;
}

.blob {
    position: absolute;
    filter: blur(90px);
    opacity: 0.35;
    mix-blend-mode: soft-light;
    will-change: transform;
    animation: blob-drift 20s infinite alternate ease-in-out;
}

/* --- Blob 1–4: upper page coverage (staggered left/right) --- */

.blob-1 {
    top: -5%;
    left: -8%;
    width: 65vw;
    height: 55vw;
    background: var(--light-sage-7);
    clip-path: polygon(
        12% 2%, 28% 0%, 45% 4%, 62% 1%, 78% 6%, 90% 12%,
        96% 28%, 100% 45%, 97% 62%, 92% 78%, 85% 90%,
        72% 96%, 55% 100%, 38% 97%, 22% 92%, 10% 85%,
        4% 72%, 0% 55%, 2% 38%, 6% 22%
    );
    animation-name: blob-drift;
    animation-duration: 35s;
    animation-delay: 0s;
}

.blob-2 {
    top: 8%;
    right: -10%;
    width: 55vw;
    height: 50vw;
    background: var(--light-sage-8);
    clip-path: polygon(
        8% 5%, 25% 1%, 42% 7%, 58% 2%, 75% 8%, 88% 15%,
        95% 30%, 98% 48%, 94% 65%, 88% 80%, 78% 92%,
        62% 98%, 45% 95%, 30% 98%, 15% 90%, 5% 78%,
        1% 60%, 3% 42%, 7% 25%
    );
    animation-name: blob-drift-2;
    animation-duration: 40s;
    animation-delay: -7s;
}

.blob-3 {
    top: 22%;
    left: 5%;
    width: 50vw;
    height: 45vw;
    background: var(--light-sage-9);
    clip-path: polygon(
        15% 3%, 32% 6%, 50% 2%, 68% 5%, 82% 10%, 93% 22%,
        98% 40%, 95% 58%, 90% 73%, 80% 88%, 65% 95%,
        48% 98%, 32% 94%, 18% 88%, 8% 75%, 2% 58%,
        0% 40%, 5% 22%
    );
    animation-name: blob-drift-3;
    animation-duration: 30s;
    animation-delay: -3s;
}

.blob-4 {
    top: 35%;
    right: 0%;
    width: 58vw;
    height: 48vw;
    background: var(--light-sage-6);
    clip-path: polygon(
        10% 8%, 26% 3%, 44% 6%, 60% 1%, 76% 7%, 90% 18%,
        97% 35%, 100% 52%, 96% 70%, 88% 84%, 75% 94%,
        58% 100%, 40% 96%, 24% 92%, 12% 82%, 4% 68%,
        0% 50%, 3% 32%
    );
    animation-name: blob-drift;
    animation-duration: 38s;
    animation-delay: -10s;
}

/* --- Blob 5–8: lower page coverage --- */

.blob-5 {
    top: 50%;
    left: -5%;
    width: 52vw;
    height: 50vw;
    background: var(--light-sage-8);
    clip-path: polygon(
        18% 5%, 35% 2%, 52% 6%, 70% 3%, 85% 12%, 94% 26%,
        98% 44%, 96% 62%, 90% 78%, 78% 90%, 62% 97%,
        44% 100%, 28% 95%, 14% 86%, 5% 72%, 1% 54%,
        3% 36%, 8% 18%
    );
    animation-name: blob-drift-2;
    animation-duration: 33s;
    animation-delay: -5s;
}

.blob-6 {
    top: 62%;
    right: -8%;
    width: 60vw;
    height: 52vw;
    background: var(--light-sage-7);
    clip-path: polygon(
        14% 4%, 30% 1%, 48% 5%, 64% 2%, 80% 8%, 92% 18%,
        98% 34%, 96% 52%, 92% 68%, 84% 82%, 70% 94%,
        52% 98%, 36% 96%, 20% 90%, 8% 78%, 2% 62%,
        0% 44%, 4% 26%
    );
    animation-name: blob-drift-3;
    animation-duration: 36s;
    animation-delay: -12s;
}

.blob-7 {
    top: 76%;
    left: 10%;
    width: 48vw;
    height: 44vw;
    background: var(--light-sage-9);
    clip-path: polygon(
        12% 6%, 28% 2%, 46% 8%, 62% 3%, 78% 10%, 90% 22%,
        96% 38%, 98% 56%, 92% 72%, 82% 86%, 66% 95%,
        48% 98%, 32% 94%, 16% 86%, 6% 72%, 1% 54%,
        2% 36%, 7% 20%
    );
    animation-name: blob-drift;
    animation-duration: 28s;
    animation-delay: -8s;
}

.blob-8 {
    top: 88%;
    right: 5%;
    width: 55vw;
    height: 50vw;
    background: var(--light-sage-8);
    clip-path: polygon(
        16% 4%, 34% 1%, 50% 6%, 66% 2%, 82% 9%, 94% 20%,
        98% 38%, 96% 56%, 90% 72%, 78% 86%, 62% 96%,
        44% 100%, 28% 95%, 14% 86%, 4% 70%, 0% 52%,
        2% 34%, 8% 18%
    );
    animation-name: blob-drift-2;
    animation-duration: 32s;
    animation-delay: -15s;
}

/* --- Noise overlay --- */

.noise-overlay {
    position: absolute;
    inset: 0;
    opacity: 0.06;
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    background-repeat: repeat;
    background-size: 256px 256px;
}

/* --- Blob drift animations (3 variants for organic variety) --- */

@keyframes blob-drift {
    0%   { transform: translate(0, 0) rotate(0deg) scale(1); }
    100% { transform: translate(30px, 15px) rotate(8deg) scale(1.03); }
}

@keyframes blob-drift-2 {
    0%   { transform: translate(0, 0) rotate(0deg) scale(1); }
    100% { transform: translate(-25px, 20px) rotate(-6deg) scale(0.97); }
}

@keyframes blob-drift-3 {
    0%   { transform: translate(0, 0) rotate(0deg) scale(1); }
    100% { transform: translate(20px, -18px) rotate(5deg) scale(1.02); }
}

@media (max-width: 860px) {
    .blob {
        filter: blur(50px);
        opacity: 0.30;
    }
}
