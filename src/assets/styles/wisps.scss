/* Sparkly Particle Wisps (Vue-rendered) */
.wisps {
    position: absolute;
    inset: 0;
    width: 100%;

    /* IMPORTANT: make the field as tall as the document */
    height: var(--pageH, 100vh);

    pointer-events: none;
    overflow: hidden;
    z-index: 0;

    /* Uniform container-level parallax (single compositor op) */
    translate: 0 var(--wispPar, 0px);
    will-change: translate;
}

/* Base wisp visual: POINT + BLOOM (not a "ball") */
.wisp {
    position: absolute;
    left: var(--x);
    top: var(--y);

    width: var(--s);
    height: var(--s);
    border-radius: 999px;

    background: transparent;

    /* crisp core + soft bloom */
    box-shadow:
            0 0 0 0.7px rgba(255, 255, 255, 0.92),
            0 0 12px rgba(255, 255, 255, 0.42),
            0 0 22px rgba(120, 255, 200, 0.28),
            0 0 36px rgba(32, 99, 63, 0.22);

    opacity: 0.82;

    mix-blend-mode: screen;

    transform: translate3d(0, 0, 0);
    will-change: transform, opacity;

    animation:
        wisp-drift var(--dur) ease-in-out var(--delay) infinite,
        wisp-twinkle var(--tw) ease-in-out var(--twDelay) infinite;
}


/* Soft star glint (rounded, not a hard right angle) */
.wisp::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;

    width: calc(var(--s) * 12);
    height: calc(var(--s) * 12);
    transform: translate(-50%, -50%) rotate(var(--rot, 0deg)) scale(0.85);

    pointer-events: none;
    opacity: 0;

    /* 4-point star + soft core */
    background:
            radial-gradient(circle, rgba(255,255,255,0.70), rgba(255,255,255,0) 38%),
            radial-gradient(circle, rgba(255,255,255,0.30), rgba(255,255,255,0) 62%),
            conic-gradient(
                            rgba(255,255,255,0) 0deg,
                            rgba(255,255,255,0.95) 7deg,
                            rgba(255,255,255,0) 14deg,
                            rgba(255,255,255,0) 90deg,
                            rgba(255,255,255,0.95) 97deg,
                            rgba(255,255,255,0) 104deg,
                            rgba(255,255,255,0) 180deg,
                            rgba(255,255,255,0.95) 187deg,
                            rgba(255,255,255,0) 194deg,
                            rgba(255,255,255,0) 270deg,
                            rgba(255,255,255,0.95) 277deg,
                            rgba(255,255,255,0) 284deg,
                            rgba(255,255,255,0) 360deg
            );

    /* KEY: taper outward so the spikes don't look wide at the edge */
    -webkit-mask-image: radial-gradient(
                    circle,
                    #000 0%,
                    #000 22%,
                    rgba(0,0,0,0.85) 34%,
                    rgba(0,0,0,0.35) 50%,
                    rgba(0,0,0,0.00) 66%
    );
    mask-image: radial-gradient(
                    circle,
                    #000 0%,
                    #000 22%,
                    rgba(0,0,0,0.85) 34%,
                    rgba(0,0,0,0.35) 50%,
                    rgba(0,0,0,0.00) 66%
    );

    filter: blur(0.55px);
}

/* --- Generic keyframes using per-particle CSS custom properties --- */

/* 6-point organic drift path — each wisp gets unique motion from its --dx / --dy */
@keyframes wisp-drift {
    0%, 100% { transform: translate3d(0, 0, 0); }
    18%      { transform: translate3d(calc(var(--dx) * -0.4),  calc(var(--dy) * 0.6),  0); }
    36%      { transform: translate3d(calc(var(--dx) * 0.8),   calc(var(--dy) * -0.3), 0); }
    54%      { transform: translate3d(var(--dx), var(--dy), 0); }
    72%      { transform: translate3d(calc(var(--dx) * -0.6),  calc(var(--dy) * 0.9),  0); }
    88%      { transform: translate3d(calc(var(--dx) * 0.3),   calc(var(--dy) * -0.5), 0); }
}

/* Soft twinkle: gentle breathing, no flicker */
@keyframes wisp-twinkle {
    0%, 100% {
        opacity: 0.38;
        filter: blur(0.10px);
    }
    35% {
        opacity: 0.62;
        filter: blur(0.22px);
    }
    55% {
        opacity: 0.92;
        filter: blur(0.34px);
    }
    70% {
        opacity: 0.52;
        filter: blur(0.16px);
    }
}

/* Occasional star glint — only applied to .has-glint wisps */
@keyframes wisp-glint {
    0%, 80%, 100% {
        opacity: 0;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.82);
        filter: blur(0.60px);
    }
    86% {
        opacity: 0.22;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.94);
        filter: blur(0.56px);
    }
    90% {
        opacity: 0.70;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(1.08);
        filter: blur(0.48px);
    }
    94% {
        opacity: 0.14;
        transform: translate(-50%, -50%) rotate(var(--rot)) scale(0.92);
        filter: blur(0.58px);
    }
}

.wisp.has-glint::before {
    animation: wisp-glint var(--glintDur) ease-in-out var(--glintDelay) infinite;
}

/* ===== Watercolor Background Layer ===== */

.watercolor-layer {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
    background-color: transparent;
}

.blob {
    position: absolute;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.7;
    mix-blend-mode: multiply;
    will-change: transform;
    animation: blob-drift 20s infinite alternate ease-in-out;
}

.blob-1 {
    top: -10%;
    left: -10%;
    width: 60vw;
    height: 60vw;
    background: var(--light-sage-4);
    animation-duration: 25s;
    animation-delay: 0s;
}

.blob-2 {
    bottom: 20%;
    right: -5%;
    width: 50vw;
    height: 50vw;
    background: var(--light-sage-1);
    animation-duration: 30s;
    animation-delay: -5s;
}

.blob-3 {
    top: 40%;
    left: 20%;
    width: 40vw;
    height: 40vw;
    background: var(--light-sage-8);
    opacity: 0.5;
    animation-duration: 22s;
    animation-delay: -2s;
}

.blob-4 {
    bottom: -10%;
    left: 10%;
    width: 45vw;
    height: 45vw;
    background: var(--light-sage-5);
    animation-duration: 28s;
    animation-delay: -8s;
}

.noise-overlay {
    position: absolute;
    inset: 0;
    opacity: 0.04;
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    background-repeat: repeat;
    background-size: 256px 256px;
}

@keyframes blob-drift {
    0% {
        transform: translate(0, 0) rotate(0deg);
    }
    100% {
        transform: translate(40px, 20px) rotate(10deg);
    }
}

@media (max-width: 860px) {
    .blob {
        filter: blur(30px);
    }
}
